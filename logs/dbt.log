[0m00:15:28.782547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAE0A04C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB0A44C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB0A44DF0>]}


============================== 00:15:28.788545 | 41b9a152-7db4-4614-a96c-8e478278643b ==============================
[0m00:15:28.788545 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:15:28.789548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init my_gcp_project', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:28.812545 [debug] [MainThread]: Starter project path: D:\ELTv2\venv\lib\site-packages\dbt\include\starter_project
[0m00:15:28.863548 [info ] [MainThread]: 
Your new dbt project "my_gcp_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m00:15:28.867546 [info ] [MainThread]: Setting up your profile.
[0m00:26:37.587220 [info ] [MainThread]: Profile my_gcp_project written to C:\Users\kumar\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m00:26:37.590186 [debug] [MainThread]: Command `dbt init` succeeded at 00:26:37.589186 after 668.93 seconds
[0m00:26:37.591188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EAE0A04C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB0A44C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB0A44A90>]}
[0m00:26:37.592189 [debug] [MainThread]: Flushing usage events
[0m00:26:56.811789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D70BC0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7356F430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7356F250>]}


============================== 00:26:56.816788 | f450b6ca-c23e-406a-865f-41711d1dead2 ==============================
[0m00:26:56.816788 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:26:56.817788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:26:56.841787 [info ] [MainThread]: dbt version: 1.8.6
[0m00:26:56.842787 [info ] [MainThread]: python version: 3.10.5
[0m00:26:56.844789 [info ] [MainThread]: python path: D:\ELTv2\venv\Scripts\python.exe
[0m00:26:56.845788 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:26:56.852787 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m00:26:57.171793 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m00:26:57.173793 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m00:26:57.174793 [info ] [MainThread]: Using dbt_project.yml file at D:\ELTv2\dbt_project.yml
[0m00:26:57.174793 [info ] [MainThread]: Configuration:
[0m00:26:57.175794 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:26:57.176793 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m00:26:57.177794 [info ] [MainThread]: Required dependencies:
[0m00:26:57.178793 [debug] [MainThread]: Executing "git --help"
[0m00:26:57.230824 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:26:57.231787 [debug] [MainThread]: STDERR: "b''"
[0m00:26:57.231787 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:26:57.233788 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:26:57.234788 [info ] [MainThread]: [31m2 checks failed:[0m
[0m00:26:57.235787 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "my_etl_project", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!

Runtime Error
  Credentials in profile "my_gcp_project", target "dev" invalid: 'schema' is a required property


[0m00:26:57.237789 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\ELTv2\dbt_project.yml> not found

[0m00:26:57.239821 [debug] [MainThread]: Command `dbt debug` failed at 00:26:57.238807 after 0.55 seconds
[0m00:26:57.239821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D70BC0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7356F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D72AB3400>]}
[0m00:26:57.240824 [debug] [MainThread]: Flushing usage events
[0m00:44:28.157370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD6FA0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD9946170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD9946350>]}


============================== 00:44:28.163370 | a73751c9-1c15-4289-b5cb-ed1b9d5b2474 ==============================
[0m00:44:28.163370 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:44:28.164368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:44:28.185141 [info ] [MainThread]: dbt version: 1.8.6
[0m00:44:28.187137 [info ] [MainThread]: python version: 3.10.5
[0m00:44:28.188151 [info ] [MainThread]: python path: D:\ELTv2\venv\Scripts\python.exe
[0m00:44:28.189138 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:44:28.523041 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m00:44:28.525080 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m00:44:28.526044 [info ] [MainThread]: Using dbt_project.yml file at D:\ELTv2\dbt_project.yml
[0m00:44:28.527044 [info ] [MainThread]: Configuration:
[0m00:44:28.528058 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:44:28.529084 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m00:44:28.530043 [info ] [MainThread]: Required dependencies:
[0m00:44:28.531044 [debug] [MainThread]: Executing "git --help"
[0m00:44:28.577045 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:44:28.578044 [debug] [MainThread]: STDERR: "b''"
[0m00:44:28.579077 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:44:28.580043 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:44:28.581149 [info ] [MainThread]: [31m2 checks failed:[0m
[0m00:44:28.582158 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "my_gcp_project", target "dev" invalid: 'schema' is a required property


[0m00:44:28.583157 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\ELTv2\dbt_project.yml> not found

[0m00:44:28.585160 [debug] [MainThread]: Command `dbt debug` failed at 00:44:28.585160 after 0.54 seconds
[0m00:44:28.586158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD6FA0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD9946350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD97B2A40>]}
[0m00:44:28.587192 [debug] [MainThread]: Flushing usage events
[0m00:53:16.621286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183736B04F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018376054BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018376054D90>]}


============================== 00:53:16.626286 | 0e127f20-53ec-4dc6-a50a-8590670b905b ==============================
[0m00:53:16.626286 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:53:16.627287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\ELTv2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:16.648286 [info ] [MainThread]: dbt version: 1.8.6
[0m00:53:16.650287 [info ] [MainThread]: python version: 3.10.5
[0m00:53:16.650287 [info ] [MainThread]: python path: D:\ELTv2\venv\Scripts\python.exe
[0m00:53:16.651287 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:53:17.026812 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m00:53:17.027808 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m00:53:17.028797 [info ] [MainThread]: Using dbt_project.yml file at D:\ELTv2\dbt_project.yml
[0m00:53:17.161800 [info ] [MainThread]: Configuration:
[0m00:53:17.162800 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:53:17.164799 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:53:17.165810 [info ] [MainThread]: Required dependencies:
[0m00:53:17.166798 [debug] [MainThread]: Executing "git --help"
[0m00:53:17.211836 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:53:17.212798 [debug] [MainThread]: STDERR: "b''"
[0m00:53:17.213797 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:53:17.214397 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:53:17.215508 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:53:17.216517 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "my_gcp_project", target "dev" invalid: 'schema' is a required property


[0m00:53:17.218519 [debug] [MainThread]: Command `dbt debug` failed at 00:53:17.218519 after 0.70 seconds
[0m00:53:17.219519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183736B04F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018373EC1CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018376054DC0>]}
[0m00:53:17.220519 [debug] [MainThread]: Flushing usage events
[0m00:55:10.823547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014908410430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001490ADB4C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001490ADB59C0>]}


============================== 00:55:10.830547 | e65e2665-099e-4fcd-a66d-0a16f86405fc ==============================
[0m00:55:10.830547 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:55:10.831511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\ELTv2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:55:10.851396 [info ] [MainThread]: dbt version: 1.8.6
[0m00:55:10.852832 [info ] [MainThread]: python version: 3.10.5
[0m00:55:10.853726 [info ] [MainThread]: python path: D:\ELTv2\venv\Scripts\python.exe
[0m00:55:10.854737 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:55:11.189189 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m00:55:11.190201 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m00:55:11.191187 [info ] [MainThread]: Using dbt_project.yml file at D:\ELTv2\dbt_project.yml
[0m00:55:11.325227 [info ] [MainThread]: Configuration:
[0m00:55:11.326192 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:55:11.327190 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:55:11.328191 [info ] [MainThread]: Required dependencies:
[0m00:55:11.330188 [debug] [MainThread]: Executing "git --help"
[0m00:55:11.374187 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:55:11.375187 [debug] [MainThread]: STDERR: "b''"
[0m00:55:11.376191 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:55:11.378203 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:55:11.379195 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:55:11.380036 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "my_gcp_project", target "dev" invalid: 'driver' is a required property


[0m00:55:11.382048 [debug] [MainThread]: Command `dbt debug` failed at 00:55:11.382048 after 0.67 seconds
[0m00:55:11.383085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014908410430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014908BD3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001490ABBB070>]}
[0m00:55:11.384049 [debug] [MainThread]: Flushing usage events
[0m00:57:36.472765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6BCB20430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6BF4CA1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6BF4CA380>]}


============================== 00:57:36.478799 | 2c08ad47-b2d2-4060-a0f4-133fc6ab2f97 ==============================
[0m00:57:36.478799 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:57:36.479767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\ELTv2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:57:36.500852 [info ] [MainThread]: dbt version: 1.8.6
[0m00:57:36.501817 [info ] [MainThread]: python version: 3.10.5
[0m00:57:36.502816 [info ] [MainThread]: python path: D:\ELTv2\venv\Scripts\python.exe
[0m00:57:36.502816 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:57:36.823221 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m00:57:36.825218 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m00:57:36.825218 [info ] [MainThread]: Using dbt_project.yml file at D:\ELTv2\dbt_project.yml
[0m00:57:36.826218 [info ] [MainThread]: adapter type: sqlserver
[0m00:57:36.827215 [info ] [MainThread]: adapter version: 1.8.2
[0m00:57:36.962291 [info ] [MainThread]: Configuration:
[0m00:57:36.963294 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:57:36.964304 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:57:36.966257 [info ] [MainThread]: Required dependencies:
[0m00:57:36.967252 [debug] [MainThread]: Executing "git --help"
[0m00:57:37.011397 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:57:37.012401 [debug] [MainThread]: STDERR: "b''"
[0m00:57:37.013395 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:57:37.014398 [info ] [MainThread]: Connection:
[0m00:57:37.015409 [info ] [MainThread]:   server: 34.65.104.120
[0m00:57:37.016396 [info ] [MainThread]:   database: APIData
[0m00:57:37.017397 [info ] [MainThread]:   schema: Landing
[0m00:57:37.018399 [info ] [MainThread]:   UID: sqlserver
[0m00:57:37.018399 [info ] [MainThread]:   client_id: None
[0m00:57:37.019430 [info ] [MainThread]:   authentication: sql
[0m00:57:37.020397 [info ] [MainThread]:   encrypt: True
[0m00:57:37.021399 [info ] [MainThread]:   trust_cert: False
[0m00:57:37.022396 [info ] [MainThread]:   retries: 1
[0m00:57:37.022396 [info ] [MainThread]:   login_timeout: 0
[0m00:57:37.024399 [info ] [MainThread]:   query_timeout: 0
[0m00:57:37.025397 [info ] [MainThread]:   trace_flag: False
[0m00:57:37.026435 [info ] [MainThread]:   port: 1433
[0m00:57:37.027396 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m00:57:37.029430 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m00:57:37.029430 [debug] [MainThread]: Using sqlserver connection "debug"
[0m00:57:37.030428 [debug] [MainThread]: On debug: select 1 as id
[0m00:57:37.030428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:57:37.031400 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.2
[0m00:57:37.204727 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')
[0m00:57:38.207467 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.8.2
[0m00:57:38.295366 [debug] [MainThread]: fabric adapter: Error running SQL: select 1 as id
[0m00:57:38.296358 [debug] [MainThread]: fabric adapter: Rolling back transaction.
[0m00:57:38.296358 [debug] [MainThread]: On debug: No close available on handle
[0m00:57:38.297338 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:57:38.298338 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:57:38.299338 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Client unable to establish connection (-2146893019)')

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:57:38.303365 [debug] [MainThread]: Command `dbt debug` failed at 00:57:38.303365 after 1.93 seconds
[0m00:57:38.304338 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:57:38.304338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6BCB20430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6BFE73580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6BCDCDA80>]}
[0m00:57:38.305356 [debug] [MainThread]: Flushing usage events
[0m00:58:59.179520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2A350400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2CCF4CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2CCF59F0>]}


============================== 00:58:59.185520 | 1e6ecad2-7102-4c18-b598-15821970c728 ==============================
[0m00:58:59.185520 [info ] [MainThread]: Running with dbt=1.8.6
[0m00:58:59.186522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:59.209520 [info ] [MainThread]: dbt version: 1.8.6
[0m00:58:59.210521 [info ] [MainThread]: python version: 3.10.5
[0m00:58:59.211522 [info ] [MainThread]: python path: D:\ELTv2\venv\Scripts\python.exe
[0m00:58:59.212522 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m00:58:59.553453 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m00:58:59.555417 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m00:58:59.555952 [info ] [MainThread]: Using dbt_project.yml file at D:\ELTv2\dbt_project.yml
[0m00:58:59.556987 [info ] [MainThread]: adapter type: sqlserver
[0m00:58:59.558019 [info ] [MainThread]: adapter version: 1.8.2
[0m00:58:59.692015 [info ] [MainThread]: Configuration:
[0m00:58:59.692982 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:58:59.694023 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:58:59.695031 [info ] [MainThread]: Required dependencies:
[0m00:58:59.695982 [debug] [MainThread]: Executing "git --help"
[0m00:58:59.739980 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:58:59.739980 [debug] [MainThread]: STDERR: "b''"
[0m00:58:59.740982 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:58:59.741982 [info ] [MainThread]: Connection:
[0m00:58:59.742983 [info ] [MainThread]:   server: 34.65.104.120
[0m00:58:59.743982 [info ] [MainThread]:   database: APIData
[0m00:58:59.744981 [info ] [MainThread]:   schema: Landing
[0m00:58:59.744981 [info ] [MainThread]:   UID: sqlserver
[0m00:58:59.746980 [info ] [MainThread]:   client_id: None
[0m00:58:59.747982 [info ] [MainThread]:   authentication: sql
[0m00:58:59.749007 [info ] [MainThread]:   encrypt: True
[0m00:58:59.750056 [info ] [MainThread]:   trust_cert: True
[0m00:58:59.750981 [info ] [MainThread]:   retries: 1
[0m00:58:59.751979 [info ] [MainThread]:   login_timeout: 0
[0m00:58:59.752978 [info ] [MainThread]:   query_timeout: 0
[0m00:58:59.753979 [info ] [MainThread]:   trace_flag: False
[0m00:58:59.753979 [info ] [MainThread]:   port: 1433
[0m00:58:59.754979 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m00:58:59.756003 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m00:58:59.757006 [debug] [MainThread]: Using sqlserver connection "debug"
[0m00:58:59.757006 [debug] [MainThread]: On debug: select 1 as id
[0m00:58:59.758002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:59.758002 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m00:59:00.052037 [debug] [MainThread]: sqlserver adapter: Connected to db: APIData
[0m00:59:00.075542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:59:00.076580 [debug] [MainThread]: On debug: Close
[0m00:59:00.077575 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:59:00.078571 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:59:00.080605 [debug] [MainThread]: Command `dbt debug` succeeded at 00:59:00.080605 after 1.00 seconds
[0m00:59:00.081606 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:59:00.082572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2A350400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2AB18280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2D6CF400>]}
[0m00:59:00.082572 [debug] [MainThread]: Flushing usage events
[0m01:05:34.665693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201893A0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018BD44B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018BD44D30>]}


============================== 01:05:34.670692 | 3de3c1d8-01cc-4e9f-9305-0a804dd9eca0 ==============================
[0m01:05:34.670692 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:05:34.671693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:05:35.244976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3de3c1d8-01cc-4e9f-9305-0a804dd9eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018964DAB0>]}
[0m01:05:35.331016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3de3c1d8-01cc-4e9f-9305-0a804dd9eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018BD03A30>]}
[0m01:05:35.332014 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m01:05:35.368976 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:05:35.370991 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:05:35.371974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3de3c1d8-01cc-4e9f-9305-0a804dd9eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018C7DB430>]}
[0m01:05:37.915355 [error] [MainThread]: Encountered an error:
Compilation Error in model products (transformation\products.sql)
  expected token ',', got 'will'
    line 5
      alias='Products'  -- This will rename the table to "Products"
[0m01:05:37.918321 [debug] [MainThread]: Command `dbt run` failed at 01:05:37.918321 after 3.36 seconds
[0m01:05:37.919283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201893A0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018DAA3C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002018DAA3D00>]}
[0m01:05:37.920283 [debug] [MainThread]: Flushing usage events
[0m01:07:10.413594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DFAEC4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E2494AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E2494CA0>]}


============================== 01:07:10.418594 | bc7e147a-c14b-418d-8dfb-c3e4edb9b97c ==============================
[0m01:07:10.418594 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:07:10.419594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:07:10.965052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc7e147a-c14b-418d-8dfb-c3e4edb9b97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DFD9DB10>]}
[0m01:07:11.067001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc7e147a-c14b-418d-8dfb-c3e4edb9b97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E2471ED0>]}
[0m01:07:11.069002 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m01:07:11.083038 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:07:11.085003 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:07:11.086044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc7e147a-c14b-418d-8dfb-c3e4edb9b97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E3008310>]}
[0m01:07:12.755054 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_gcp_project.products' (transformation\products.sql) depends on a node named 'Landing_raw__stream_API_Source_Connector' which was not found
[0m01:07:12.758015 [debug] [MainThread]: Command `dbt run` failed at 01:07:12.758015 after 2.45 seconds
[0m01:07:12.759017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DFAEC4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E4317970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E43179D0>]}
[0m01:07:12.759534 [debug] [MainThread]: Flushing usage events
[0m01:54:46.319060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184A8D40490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AB6D4AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AB6D4CD0>]}


============================== 01:54:46.326042 | 30a0830d-5cfd-43e7-aaf3-8993ce4f712a ==============================
[0m01:54:46.326042 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:54:46.327044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\ELTv2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:54:46.830040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30a0830d-5cfd-43e7-aaf3-8993ce4f712a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AC0BB280>]}
[0m01:54:46.914089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30a0830d-5cfd-43e7-aaf3-8993ce4f712a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AC0B84F0>]}
[0m01:54:46.915045 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m01:54:46.930077 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:54:46.932043 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:54:46.933047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30a0830d-5cfd-43e7-aaf3-8993ce4f712a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AC249900>]}
[0m01:54:48.464509 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_gcp_project.products' (transformation\products.sql) depends on a node named 'Landing_raw__stream_API_Source_Connector' which was not found
[0m01:54:48.466509 [debug] [MainThread]: Command `dbt run` failed at 01:54:48.466509 after 2.24 seconds
[0m01:54:48.467534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184A8D40490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AD587A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184AD555D80>]}
[0m01:54:48.468534 [debug] [MainThread]: Flushing usage events
[0m01:56:01.037243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34FDD0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B352774B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B352774D30>]}


============================== 01:56:01.043207 | 9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7 ==============================
[0m01:56:01.043207 [info ] [MainThread]: Running with dbt=1.8.6
[0m01:56:01.044208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\ELTv2\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:56:01.550755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35007DAB0>]}
[0m01:56:01.635755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B352733A30>]}
[0m01:56:01.637763 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m01:56:01.651753 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m01:56:01.653738 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:56:01.654519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35320B430>]}
[0m01:56:03.239074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35315F700>]}
[0m01:56:03.359043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B354590790>]}
[0m01:56:03.360058 [info ] [MainThread]: Found 1 model, 492 macros
[0m01:56:03.361043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B354590AF0>]}
[0m01:56:03.363077 [info ] [MainThread]: 
[0m01:56:03.364041 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m01:56:03.366040 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m01:56:03.382074 [debug] [ThreadPool]: dbt-sqlserver
[0m01:56:03.383042 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m01:56:03.383042 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m01:56:03.384074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:03.385041 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m01:56:03.609728 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m01:56:03.637952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:56:03.639961 [debug] [ThreadPool]: On list_APIData: Close
[0m01:56:03.640963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_APIData, now create_APIData_Landing_Landing)
[0m01:56:03.642089 [debug] [ThreadPool]: Creating schema "database: "APIData"
schema: "Landing_Landing"
"
[0m01:56:03.648131 [debug] [ThreadPool]: Using sqlserver connection "create_APIData_Landing_Landing"
[0m01:56:03.649119 [debug] [ThreadPool]: On create_APIData_Landing_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "create_APIData_Landing_Landing"} */
USE [APIData];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'Landing_Landing')
    BEGIN
    EXEC('CREATE SCHEMA [Landing_Landing]')
    END
  
[0m01:56:03.649119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:03.650135 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m01:56:03.650135 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m01:56:03.687814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:56:03.688826 [debug] [ThreadPool]: On create_APIData_Landing_Landing: COMMIT
[0m01:56:03.689860 [debug] [ThreadPool]: On create_APIData_Landing_Landing: Close
[0m01:56:03.691829 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing_Landing'
[0m01:56:03.700856 [debug] [ThreadPool]: dbt-sqlserver
[0m01:56:03.701832 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing_Landing"
[0m01:56:03.701832 [debug] [ThreadPool]: On list_APIData_Landing_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing_Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m01:56:03.702862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:03.702862 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m01:56:03.703824 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m01:56:03.778082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:56:03.780090 [debug] [ThreadPool]: On list_APIData_Landing_Landing: ROLLBACK
[0m01:56:03.781047 [debug] [ThreadPool]: On list_APIData_Landing_Landing: Close
[0m01:56:03.783034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35476FD60>]}
[0m01:56:03.784033 [debug] [MainThread]: On master: COMMIT
[0m01:56:03.785039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:03.786040 [info ] [MainThread]: 
[0m01:56:03.792216 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m01:56:03.793215 [info ] [Thread-1 (]: 1 of 1 START sql view model Landing_Landing.Products ........................... [RUN]
[0m01:56:03.794218 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m01:56:03.795217 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m01:56:03.805249 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m01:56:03.807215 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m01:56:03.858249 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m01:56:03.860215 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m01:56:03.861215 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing_Landing"."Products__dbt_tmp" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')


[0m01:56:03.863216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:56:03.864218 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m01:56:03.865219 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m01:56:03.897227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:03.905249 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m01:56:03.906216 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing_Landing.Products__dbt_tmp', 'Products'
[0m01:56:04.250350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:04.267919 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m01:56:04.274918 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_backup"
[0m01:56:04.282919 [debug] [Thread-1 (]: dbt-sqlserver
[0m01:56:04.283918 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m01:56:04.283918 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing_Landing'
        and refs.referenced_entity_name = 'Products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m01:56:04.345910 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:04.348938 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m01:56:04.350939 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing_Landing"."Products__dbt_backup";');

[0m01:56:04.377936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:04.381941 [debug] [Thread-1 (]: On model.my_gcp_project.products: ROLLBACK
[0m01:56:04.382934 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m01:56:04.385938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a572b1d-a6f1-4ac8-bb50-6b6f85ad4db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35477BC70>]}
[0m01:56:04.387935 [info ] [Thread-1 (]: 1 of 1 OK created sql view model Landing_Landing.Products ...................... [[32mOK[0m in 0.59s]
[0m01:56:04.389935 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m01:56:04.392936 [debug] [MainThread]: On master: COMMIT
[0m01:56:04.393941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:04.394936 [debug] [MainThread]: Connection 'create_APIData_Landing_Landing' was properly closed.
[0m01:56:04.395941 [debug] [MainThread]: Connection 'list_APIData_Landing_Landing' was properly closed.
[0m01:56:04.395941 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m01:56:04.396939 [info ] [MainThread]: 
[0m01:56:04.397939 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m01:56:04.399972 [debug] [MainThread]: Command end result
[0m01:56:04.436948 [info ] [MainThread]: 
[0m01:56:04.437935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:04.438936 [info ] [MainThread]: 
[0m01:56:04.439935 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:56:04.441953 [debug] [MainThread]: Command `dbt run` succeeded at 01:56:04.440935 after 3.50 seconds
[0m01:56:04.441953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34FDD0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B352733A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B351CF5000>]}
[0m01:56:04.442953 [debug] [MainThread]: Flushing usage events
[0m02:00:55.477865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911A370490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911CD14AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911CD14CD0>]}


============================== 02:00:55.482898 | abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b ==============================
[0m02:00:55.482898 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:00:55.483901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\ELTv2\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:00:55.982044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911D6FB280>]}
[0m02:00:56.075019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911D6F84F0>]}
[0m02:00:56.076018 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m02:00:56.091980 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:00:56.280019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:56.281031 [debug] [MainThread]: Partial parsing: updated file: my_gcp_project://transformation\products.sql
[0m02:00:56.639015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911CB15780>]}
[0m02:00:56.751980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EA5DA50>]}
[0m02:00:56.752980 [info ] [MainThread]: Found 1 model, 492 macros
[0m02:00:56.753981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EA677F0>]}
[0m02:00:56.756015 [info ] [MainThread]: 
[0m02:00:56.757981 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:00:56.759014 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m02:00:56.777983 [debug] [ThreadPool]: dbt-sqlserver
[0m02:00:56.778983 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m02:00:56.778983 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:00:56.779984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:56.779984 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:00:57.023327 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:00:57.051215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:00:57.052931 [debug] [ThreadPool]: On list_APIData: Close
[0m02:00:57.054902 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing_Landing'
[0m02:00:57.063932 [debug] [ThreadPool]: dbt-sqlserver
[0m02:00:57.064945 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing_Landing"
[0m02:00:57.064945 [debug] [ThreadPool]: On list_APIData_Landing_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing_Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:00:57.065933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:57.065933 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:00:57.066899 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:00:57.093241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:00:57.095980 [debug] [ThreadPool]: On list_APIData_Landing_Landing: ROLLBACK
[0m02:00:57.095980 [debug] [ThreadPool]: On list_APIData_Landing_Landing: Close
[0m02:00:57.097943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911D7BC970>]}
[0m02:00:57.097943 [debug] [MainThread]: On master: COMMIT
[0m02:00:57.098973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:00:57.099939 [info ] [MainThread]: 
[0m02:00:57.104932 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m02:00:57.105967 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing_Landing.Products .......................... [RUN]
[0m02:00:57.106961 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m02:00:57.107943 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m02:00:57.117965 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m02:00:57.118966 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m02:00:57.167973 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:00:57.176976 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m02:00:57.184978 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:00:57.185974 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.186939 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing_Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m02:00:57.186939 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:00:57.187990 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:00:57.187990 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m02:00:57.229992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.231974 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.232943 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m02:00:57.255817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.270876 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m02:00:57.271844 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.272843 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing_Landing"."Products__dbt_tmp" FROM "APIData"."Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing_Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Landing_Products__dbt_tmp')
    )
    DROP index "Landing_Landing"."Products__dbt_tmp".Landing_Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Landing_Products__dbt_tmp_cci
    ON "Landing_Landing"."Products__dbt_tmp"

   


  
[0m02:00:57.594159 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.601217 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.602217 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing_Landing.Products', 'Products__dbt_backup'
[0m02:00:57.628562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.632609 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.633589 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing_Landing.Products__dbt_tmp', 'Products'
[0m02:00:57.699258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.720266 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m02:00:57.724267 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_backup"
[0m02:00:57.725267 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:00:57.726267 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.726267 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing_Landing'
        and refs.referenced_entity_name = 'Products__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m02:00:57.750705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.752742 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:00:57.752742 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing_Landing"."Products__dbt_backup";');

[0m02:00:57.778391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:00:57.781399 [debug] [Thread-1 (]: On model.my_gcp_project.products: ROLLBACK
[0m02:00:57.781399 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m02:00:57.783400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcdf23d-cd61-4f8a-b74d-a1f9bda24b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EBEC400>]}
[0m02:00:57.784400 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing_Landing.Products ..................... [[32mOK[0m in 0.68s]
[0m02:00:57.785562 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m02:00:57.787592 [debug] [MainThread]: On master: COMMIT
[0m02:00:57.788622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:57.789615 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m02:00:57.789615 [debug] [MainThread]: Connection 'list_APIData_Landing_Landing' was properly closed.
[0m02:00:57.790622 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m02:00:57.790622 [info ] [MainThread]: 
[0m02:00:57.791621 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m02:00:57.793590 [debug] [MainThread]: Command end result
[0m02:00:57.832590 [info ] [MainThread]: 
[0m02:00:57.833590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:57.834587 [info ] [MainThread]: 
[0m02:00:57.835648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:00:57.837620 [debug] [MainThread]: Command `dbt run` succeeded at 02:00:57.837620 after 2.46 seconds
[0m02:00:57.837620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911A370490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911C2A0FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EA67820>]}
[0m02:00:57.838587 [debug] [MainThread]: Flushing usage events
[0m02:03:07.621116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EC170460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEB14B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEB14D30>]}


============================== 02:03:07.627117 | 3c2c147d-9a7a-4c98-b4dd-e227035bfd0e ==============================
[0m02:03:07.627117 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:03:07.628117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:08.111116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EC41DAB0>]}
[0m02:03:08.193116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EEAD3A30>]}
[0m02:03:08.194117 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m02:03:08.208115 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:03:08.305117 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:03:08.307117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EE0A1090>]}
[0m02:03:09.866213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F0974430>]}
[0m02:03:09.977210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F09E9870>]}
[0m02:03:09.978210 [info ] [MainThread]: Found 1 model, 492 macros
[0m02:03:09.979231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EC568EE0>]}
[0m02:03:09.981250 [info ] [MainThread]: 
[0m02:03:09.983212 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:03:09.985215 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m02:03:10.002213 [debug] [ThreadPool]: dbt-sqlserver
[0m02:03:10.002213 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m02:03:10.003214 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:03:10.003214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:10.004214 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:10.238199 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:03:10.261993 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:10.263964 [debug] [ThreadPool]: On list_APIData: Close
[0m02:03:10.264932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_APIData, now create_APIData_Landing_Landing)
[0m02:03:10.264932 [debug] [ThreadPool]: Creating schema "database: "APIData"
schema: "Landing_Landing"
"
[0m02:03:10.270963 [debug] [ThreadPool]: Using sqlserver connection "create_APIData_Landing_Landing"
[0m02:03:10.270963 [debug] [ThreadPool]: On create_APIData_Landing_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "create_APIData_Landing_Landing"} */
USE [APIData];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'Landing_Landing')
    BEGIN
    EXEC('CREATE SCHEMA [Landing_Landing]')
    END
  
[0m02:03:10.271932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:03:10.272934 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:10.272934 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:03:10.305316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:10.307356 [debug] [ThreadPool]: On create_APIData_Landing_Landing: COMMIT
[0m02:03:10.307356 [debug] [ThreadPool]: On create_APIData_Landing_Landing: Close
[0m02:03:10.309391 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing_Landing'
[0m02:03:10.318360 [debug] [ThreadPool]: dbt-sqlserver
[0m02:03:10.319322 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing_Landing"
[0m02:03:10.319322 [debug] [ThreadPool]: On list_APIData_Landing_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing_Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:03:10.320361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:10.320361 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:10.321322 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:03:10.354086 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:10.356147 [debug] [ThreadPool]: On list_APIData_Landing_Landing: ROLLBACK
[0m02:03:10.356147 [debug] [ThreadPool]: On list_APIData_Landing_Landing: Close
[0m02:03:10.357144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F0AE2350>]}
[0m02:03:10.358110 [debug] [MainThread]: On master: COMMIT
[0m02:03:10.359110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:10.360114 [info ] [MainThread]: 
[0m02:03:10.364140 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m02:03:10.365136 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing_Landing.Products .......................... [RUN]
[0m02:03:10.367113 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m02:03:10.368114 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m02:03:10.378135 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m02:03:10.379133 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m02:03:10.429144 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:03:10.436152 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m02:03:10.444150 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:03:10.445123 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:10.445123 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing_Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m02:03:10.446111 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:10.447154 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:10.448128 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m02:03:10.470120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:10.472138 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:10.473144 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m02:03:10.507157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:10.521973 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m02:03:10.522937 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:10.523937 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing_Landing"."Products__dbt_tmp" FROM "APIData"."Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing_Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Landing_Products__dbt_tmp')
    )
    DROP index "Landing_Landing"."Products__dbt_tmp".Landing_Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Landing_Products__dbt_tmp_cci
    ON "Landing_Landing"."Products__dbt_tmp"

   


  
[0m02:03:10.694400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:10.702412 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:10.703413 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing_Landing.Products__dbt_tmp', 'Products'
[0m02:03:10.755255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:10.776193 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m02:03:10.779194 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_backup"
[0m02:03:10.781197 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:10.781197 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing_Landing"."Products__dbt_backup";');

[0m02:03:10.804837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:10.807897 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m02:03:10.809895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c2c147d-9a7a-4c98-b4dd-e227035bfd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F0AFA830>]}
[0m02:03:10.810863 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing_Landing.Products ..................... [[32mOK[0m in 0.44s]
[0m02:03:10.811864 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m02:03:10.813864 [debug] [MainThread]: On master: COMMIT
[0m02:03:10.814876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:10.814876 [debug] [MainThread]: Connection 'create_APIData_Landing_Landing' was properly closed.
[0m02:03:10.815890 [debug] [MainThread]: Connection 'list_APIData_Landing_Landing' was properly closed.
[0m02:03:10.815890 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m02:03:10.816870 [info ] [MainThread]: 
[0m02:03:10.817863 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m02:03:10.819882 [debug] [MainThread]: Command end result
[0m02:03:10.856863 [info ] [MainThread]: 
[0m02:03:10.858867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:10.859861 [info ] [MainThread]: 
[0m02:03:10.860862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:03:10.862910 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:10.862910 after 3.34 seconds
[0m02:03:10.862910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EC170460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EE0A1DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165EBFEDCF0>]}
[0m02:03:10.864100 [debug] [MainThread]: Flushing usage events
[0m02:03:43.853417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BE3104C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C0CB4AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C0CB4CA0>]}


============================== 02:03:43.859416 | 744e92ec-fd09-439d-b982-480941337fb1 ==============================
[0m02:03:43.859416 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:03:43.860415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\ELTv2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:44.333455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BE5BDB10>]}
[0m02:03:44.427354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C0C91ED0>]}
[0m02:03:44.428381 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m02:03:44.442632 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:03:44.537305 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:03:44.538296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C0243370>]}
[0m02:03:46.100922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C2B14490>]}
[0m02:03:46.215805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C2B3DFC0>]}
[0m02:03:46.215805 [info ] [MainThread]: Found 1 model, 492 macros
[0m02:03:46.217806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BE711F30>]}
[0m02:03:46.219805 [info ] [MainThread]: 
[0m02:03:46.221671 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:03:46.223619 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m02:03:46.237655 [debug] [ThreadPool]: dbt-sqlserver
[0m02:03:46.238621 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m02:03:46.239621 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:03:46.240621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:46.241626 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:46.470828 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:03:46.496136 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:46.497135 [debug] [ThreadPool]: On list_APIData: Close
[0m02:03:46.499107 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing_Landing'
[0m02:03:46.508141 [debug] [ThreadPool]: dbt-sqlserver
[0m02:03:46.509137 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing_Landing"
[0m02:03:46.510135 [debug] [ThreadPool]: On list_APIData_Landing_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing_Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:03:46.510135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:46.511134 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:46.511134 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:03:46.540173 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:03:46.542224 [debug] [ThreadPool]: On list_APIData_Landing_Landing: ROLLBACK
[0m02:03:46.542224 [debug] [ThreadPool]: On list_APIData_Landing_Landing: Close
[0m02:03:46.544183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C2B8F040>]}
[0m02:03:46.544183 [debug] [MainThread]: On master: COMMIT
[0m02:03:46.545216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:46.546181 [info ] [MainThread]: 
[0m02:03:46.551200 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m02:03:46.552201 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing_Landing.Products .......................... [RUN]
[0m02:03:46.553184 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m02:03:46.554185 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m02:03:46.564215 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m02:03:46.565183 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m02:03:46.621212 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:03:46.629973 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m02:03:46.638036 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:03:46.639098 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:46.639639 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing_Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m02:03:46.640709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:46.641304 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:03:46.642435 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m02:03:46.663472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:46.665393 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:46.666392 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m02:03:46.691355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:46.706393 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m02:03:46.707356 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:46.708360 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing_Landing"."Products__dbt_tmp" FROM "APIData"."Landing_Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing_Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Landing_Products__dbt_tmp')
    )
    DROP index "Landing_Landing"."Products__dbt_tmp".Landing_Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Landing_Products__dbt_tmp_cci
    ON "Landing_Landing"."Products__dbt_tmp"

   


  
[0m02:03:46.816374 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:46.824418 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:46.824418 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing_Landing.Products', 'Products__dbt_backup'
[0m02:03:46.850422 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:46.854455 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:46.855454 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing_Landing.Products__dbt_tmp', 'Products'
[0m02:03:46.882059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:46.905117 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m02:03:46.908783 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing_Landing"."Products__dbt_backup"
[0m02:03:46.909746 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:03:46.910746 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing_Landing"."Products__dbt_backup";');

[0m02:03:46.936428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:03:46.939459 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m02:03:46.941459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '744e92ec-fd09-439d-b982-480941337fb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BE5BDFF0>]}
[0m02:03:46.942429 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing_Landing.Products ..................... [[32mOK[0m in 0.39s]
[0m02:03:46.943428 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m02:03:46.945427 [debug] [MainThread]: On master: COMMIT
[0m02:03:46.946478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:46.946478 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m02:03:46.947427 [debug] [MainThread]: Connection 'list_APIData_Landing_Landing' was properly closed.
[0m02:03:46.947427 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m02:03:46.948451 [info ] [MainThread]: 
[0m02:03:46.949450 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m02:03:46.951429 [debug] [MainThread]: Command end result
[0m02:03:46.988468 [info ] [MainThread]: 
[0m02:03:46.989918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:46.990930 [info ] [MainThread]: 
[0m02:03:46.991929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:03:46.993955 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:46.992929 after 3.24 seconds
[0m02:03:46.993955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BE3104C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6C0241000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BE711F30>]}
[0m02:03:46.994954 [debug] [MainThread]: Flushing usage events
[0m02:04:11.340813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A831F0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A85B94BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A85B94D90>]}


============================== 02:04:11.345813 | 4d26f4ff-05e4-49d3-9f12-3cf012fc2902 ==============================
[0m02:04:11.345813 [info ] [MainThread]: Running with dbt=1.8.6
[0m02:04:11.346813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\ELTv2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:04:11.833816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8349DA50>]}
[0m02:04:11.938813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8510CA30>]}
[0m02:04:11.939815 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m02:04:11.956814 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m02:04:12.148851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:04:12.149853 [debug] [MainThread]: Partial parsing: updated file: my_gcp_project://transformation\products.sql
[0m02:04:12.507450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A85995FC0>]}
[0m02:04:12.619580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A878E79A0>]}
[0m02:04:12.620581 [info ] [MainThread]: Found 1 model, 492 macros
[0m02:04:12.621597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A878E7A60>]}
[0m02:04:12.623623 [info ] [MainThread]: 
[0m02:04:12.624582 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m02:04:12.626585 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m02:04:12.642583 [debug] [ThreadPool]: dbt-sqlserver
[0m02:04:12.643616 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m02:04:12.644583 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:04:12.644583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:12.645602 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:04:12.884339 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:04:12.906361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:04:12.908405 [debug] [ThreadPool]: On list_APIData: Close
[0m02:04:12.910527 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m02:04:12.919536 [debug] [ThreadPool]: dbt-sqlserver
[0m02:04:12.920536 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m02:04:12.920536 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m02:04:12.921537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:12.921537 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:04:12.922535 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m02:04:12.980365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:04:12.982423 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m02:04:12.982423 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m02:04:12.984393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A87A72EF0>]}
[0m02:04:12.984393 [debug] [MainThread]: On master: COMMIT
[0m02:04:12.985424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:12.986402 [info ] [MainThread]: 
[0m02:04:12.990390 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m02:04:12.992395 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m02:04:12.993393 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m02:04:12.994397 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m02:04:13.004425 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m02:04:13.005392 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m02:04:13.058392 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:04:13.067393 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m02:04:13.076392 [debug] [Thread-1 (]: dbt-sqlserver
[0m02:04:13.077392 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:04:13.078394 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m02:04:13.078394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:13.079394 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m02:04:13.080394 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m02:04:13.118390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:04:13.120424 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:04:13.121423 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m02:04:13.142753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:04:13.158762 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m02:04:13.159762 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:04:13.160763 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m02:04:13.277532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:04:13.284590 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:04:13.285589 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m02:04:13.310814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:04:13.329822 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m02:04:13.333822 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m02:04:13.334823 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m02:04:13.335836 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m02:04:13.357358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:04:13.360103 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m02:04:13.362104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d26f4ff-05e4-49d3-9f12-3cf012fc2902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A878DFD30>]}
[0m02:04:13.363103 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 0.37s]
[0m02:04:13.365071 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m02:04:13.366079 [debug] [MainThread]: On master: COMMIT
[0m02:04:13.367104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:13.368070 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m02:04:13.368070 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m02:04:13.369069 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m02:04:13.369069 [info ] [MainThread]: 
[0m02:04:13.370020 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m02:04:13.372030 [debug] [MainThread]: Command end result
[0m02:04:13.409029 [info ] [MainThread]: 
[0m02:04:13.409917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:13.410943 [info ] [MainThread]: 
[0m02:04:13.411950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:04:13.413948 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:13.413948 after 2.17 seconds
[0m02:04:13.415946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A831F0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8780CD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A864C7C10>]}
[0m02:04:13.416963 [debug] [MainThread]: Flushing usage events
[0m03:01:54.006155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027333AF0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273364FE140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273364FE320>]}


============================== 03:01:54.020747 | cdbcfda5-ee1f-4525-9f1c-278a73dfff15 ==============================
[0m03:01:54.020747 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:01:54.023742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\ELTv2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:02:01.359385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdbcfda5-ee1f-4525-9f1c-278a73dfff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273341FEE00>]}
[0m03:02:01.687906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdbcfda5-ee1f-4525-9f1c-278a73dfff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027336C218A0>]}
[0m03:02:01.690905 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m03:02:01.777190 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:02:02.143228 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:02:02.147738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdbcfda5-ee1f-4525-9f1c-278a73dfff15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027335950FA0>]}
[0m03:02:06.446360 [error] [MainThread]: Encountered an error:
Compilation Error in model add_columns (transformation\add_columns.sql)
  expected token ',', got 'it'
    line 6
      alias='Products'  -- Ensures it modifies the same table
[0m03:02:06.448497 [debug] [MainThread]: Command `dbt run` failed at 03:02:06.447959 after 12.81 seconds
[0m03:02:06.449557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027333AF0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273380896F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027338088A60>]}
[0m03:02:06.450567 [debug] [MainThread]: Flushing usage events
[0m03:04:54.816841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89D360490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89FD6E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89FD6E2F0>]}


============================== 03:04:54.834839 | 1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25 ==============================
[0m03:04:54.834839 [info ] [MainThread]: Running with dbt=1.8.6
[0m03:04:54.836841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\ELTv2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:04:56.132113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89FCDB520>]}
[0m03:04:56.303063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89F1C24A0>]}
[0m03:04:56.304999 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m03:04:56.348345 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m03:04:56.710470 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:04:56.713604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89F1C0FD0>]}
[0m03:05:02.166677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m03:05:02.196233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A194FD30>]}
[0m03:05:02.773272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A19A4640>]}
[0m03:05:02.775271 [info ] [MainThread]: Found 1 model, 492 macros
[0m03:05:02.777272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A19A46A0>]}
[0m03:05:02.783813 [info ] [MainThread]: 
[0m03:05:02.786804 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m03:05:02.791804 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m03:05:02.863355 [debug] [ThreadPool]: dbt-sqlserver
[0m03:05:02.866031 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m03:05:02.868033 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m03:05:02.869034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:02.871031 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m03:05:03.797079 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m03:05:03.844161 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m03:05:03.850157 [debug] [ThreadPool]: On list_APIData: Close
[0m03:05:03.854688 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m03:05:03.881731 [debug] [ThreadPool]: dbt-sqlserver
[0m03:05:03.883730 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m03:05:03.884725 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m03:05:03.885723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:03.887723 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m03:05:03.890722 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m03:05:03.998107 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:05:04.004115 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m03:05:04.006107 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m03:05:04.010109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8A19F44C0>]}
[0m03:05:04.012115 [debug] [MainThread]: On master: COMMIT
[0m03:05:04.015113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:04.017119 [info ] [MainThread]: 
[0m03:05:04.038644 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m03:05:04.041636 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m03:05:04.044924 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m03:05:04.047650 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m03:05:04.094935 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m03:05:04.102936 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m03:05:04.295213 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:05:04.320749 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m03:05:04.342295 [debug] [Thread-1 (]: dbt-sqlserver
[0m03:05:04.344287 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m03:05:04.346298 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m03:05:04.348285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:05:04.351289 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m03:05:04.353287 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m03:05:04.411424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:05:04.415425 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m03:05:04.417976 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m03:05:04.446069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:05:04.481068 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m03:05:04.484667 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m03:05:04.487666 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m03:05:04.832647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:05:04.858198 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m03:05:04.860200 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products', 'Products__dbt_backup'
[0m03:05:05.291510 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:05:05.309664 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m03:05:05.311663 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m03:05:05.339308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:05:05.425590 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m03:05:05.439601 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m03:05:05.445595 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m03:05:05.448587 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m03:05:05.483694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:05:05.492821 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m03:05:05.499827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b432b96-9acd-44c6-ba9d-3bf1c7a8dd25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89D3F5F90>]}
[0m03:05:05.502699 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 1.45s]
[0m03:05:05.507700 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m03:05:05.511693 [debug] [MainThread]: On master: COMMIT
[0m03:05:05.514698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:05.517260 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m03:05:05.520229 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m03:05:05.522227 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m03:05:05.527228 [info ] [MainThread]: 
[0m03:05:05.530227 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m03:05:05.534237 [debug] [MainThread]: Command end result
[0m03:05:05.677880 [info ] [MainThread]: 
[0m03:05:05.680880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:05.682881 [info ] [MainThread]: 
[0m03:05:05.684880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:05:05.690881 [debug] [MainThread]: Command `dbt run` succeeded at 03:05:05.689880 after 11.03 seconds
[0m03:05:05.692879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89D360490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89F1C24A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89F727730>]}
[0m03:05:05.694881 [debug] [MainThread]: Flushing usage events
[0m11:50:03.702247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE412704C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE43C7E0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE43C7E290>]}


============================== 11:50:03.711895 | 89ba44c8-35a0-4344-a516-af23afac57c6 ==============================
[0m11:50:03.711895 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:50:03.713250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'send_anonymous_usage_stats': 'True'}
[0m11:50:11.314287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE44320B80>]}
[0m11:50:11.500469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE40A7A110>]}
[0m11:50:11.503469 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m11:50:11.580099 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:50:14.309975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:14.311975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:14.335924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m11:50:14.416777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE457A9B40>]}
[0m11:50:14.842279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE444EA2C0>]}
[0m11:50:14.843279 [info ] [MainThread]: Found 1 model, 492 macros
[0m11:50:14.845281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE456D82B0>]}
[0m11:50:14.850315 [info ] [MainThread]: 
[0m11:50:14.852282 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m11:50:14.856281 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m11:50:14.904313 [debug] [ThreadPool]: dbt-sqlserver
[0m11:50:14.906280 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m11:50:14.907317 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:50:14.908313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:14.910279 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:50:15.410897 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m11:50:15.434896 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m11:50:15.439898 [debug] [ThreadPool]: On list_APIData: Close
[0m11:50:15.444637 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m11:50:15.476514 [debug] [ThreadPool]: dbt-sqlserver
[0m11:50:15.478886 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m11:50:15.479875 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:50:15.481876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:15.482876 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:50:15.484877 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m11:50:15.548547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:50:15.552933 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m11:50:15.554663 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m11:50:15.559630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE444E9A50>]}
[0m11:50:15.561359 [debug] [MainThread]: On master: COMMIT
[0m11:50:15.563260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:15.564779 [info ] [MainThread]: 
[0m11:50:15.580228 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m11:50:15.583292 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m11:50:15.585980 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m11:50:15.587976 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m11:50:15.621670 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m11:50:15.626672 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m11:50:15.761551 [debug] [Thread-1 (]: dbt-sqlserver
[0m11:50:15.787552 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m11:50:15.814549 [debug] [Thread-1 (]: dbt-sqlserver
[0m11:50:15.815548 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:50:15.817550 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m11:50:15.819551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:50:15.820549 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:50:15.940772 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m11:50:15.991075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:50:15.995074 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:50:15.996075 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m11:50:16.018818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:50:16.042848 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m11:50:16.044849 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:50:16.046848 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m11:50:16.226847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:50:16.246521 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:50:16.248522 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products', 'Products__dbt_backup'
[0m11:50:16.589256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:50:16.600258 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:50:16.602257 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m11:50:16.629257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:50:16.692257 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m11:50:16.705561 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m11:50:16.708561 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:50:16.710560 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m11:50:16.741355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:50:16.749422 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m11:50:16.755422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ba44c8-35a0-4344-a516-af23afac57c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE41305FC0>]}
[0m11:50:16.757421 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 1.17s]
[0m11:50:16.760420 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m11:50:16.764420 [debug] [MainThread]: On master: COMMIT
[0m11:50:16.766421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:16.767420 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m11:50:16.768419 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m11:50:16.769420 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m11:50:16.772109 [info ] [MainThread]: 
[0m11:50:16.774435 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m11:50:16.779434 [debug] [MainThread]: Command end result
[0m11:50:16.936633 [info ] [MainThread]: 
[0m11:50:16.937633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:16.939630 [info ] [MainThread]: 
[0m11:50:16.942626 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:50:16.951468 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:16.950469 after 13.41 seconds
[0m11:50:16.952467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE412704C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE4579E4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE4579FA60>]}
[0m11:50:16.954467 [debug] [MainThread]: Flushing usage events
[0m11:51:17.474497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30CB004F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30F50E0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30F50E290>]}


============================== 11:51:17.489975 | f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7 ==============================
[0m11:51:17.489975 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:51:17.492498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\ELTv2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:19.149966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30FDCA920>]}
[0m11:51:19.446976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30EEEF040>]}
[0m11:51:19.450977 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m11:51:19.545430 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:51:20.290311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:20.292306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:20.319598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m11:51:20.412021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A311039B70>]}
[0m11:51:20.876955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30FDC9F00>]}
[0m11:51:20.878953 [info ] [MainThread]: Found 1 model, 492 macros
[0m11:51:20.880949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30CCECFA0>]}
[0m11:51:20.886952 [info ] [MainThread]: 
[0m11:51:20.891497 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m11:51:20.896505 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m11:51:20.974130 [debug] [ThreadPool]: dbt-sqlserver
[0m11:51:20.976135 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m11:51:20.978133 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:51:20.981141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:20.983132 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:51:21.536125 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m11:51:21.562128 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m11:51:21.579125 [debug] [ThreadPool]: On list_APIData: Close
[0m11:51:21.585134 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m11:51:21.649525 [debug] [ThreadPool]: dbt-sqlserver
[0m11:51:21.651523 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m11:51:21.653522 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:51:21.657049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:21.660571 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:51:21.663568 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m11:51:21.691095 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:51:21.702094 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m11:51:21.704095 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m11:51:21.714575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30FDC8AC0>]}
[0m11:51:21.716592 [debug] [MainThread]: On master: COMMIT
[0m11:51:21.718500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:21.720449 [info ] [MainThread]: 
[0m11:51:21.766900 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m11:51:21.772901 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m11:51:21.775901 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m11:51:21.778433 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m11:51:21.823966 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m11:51:21.838511 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m11:51:22.146146 [debug] [Thread-1 (]: dbt-sqlserver
[0m11:51:22.187682 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m11:51:22.256438 [debug] [Thread-1 (]: dbt-sqlserver
[0m11:51:22.259681 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:51:22.262367 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m11:51:22.265365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:22.267462 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:51:22.403760 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m11:51:22.430774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:22.440759 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:51:22.443763 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m11:51:22.469768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:22.544846 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m11:51:22.548843 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:51:22.551835 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m11:51:22.698837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:22.730375 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:51:22.732365 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m11:51:22.762859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:22.842182 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m11:51:22.856178 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m11:51:22.861178 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:51:22.864179 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m11:51:22.891175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:51:22.900180 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m11:51:22.906182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0a79c0d-7c8d-431e-a5f3-9f3e3ade11d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31101FF40>]}
[0m11:51:22.908181 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 1.13s]
[0m11:51:22.910179 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m11:51:22.915177 [debug] [MainThread]: On master: COMMIT
[0m11:51:22.917175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:22.919180 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m11:51:22.920181 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m11:51:22.922801 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m11:51:22.925147 [info ] [MainThread]: 
[0m11:51:22.927594 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m11:51:22.935826 [debug] [MainThread]: Command end result
[0m11:51:23.077673 [info ] [MainThread]: 
[0m11:51:23.079677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:23.082669 [info ] [MainThread]: 
[0m11:51:23.084671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:23.091418 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:23.090883 after 5.88 seconds
[0m11:51:23.094416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30CB004F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30C276350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30FE7B940>]}
[0m11:51:23.096415 [debug] [MainThread]: Flushing usage events
[0m11:59:14.659054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A988D0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9B2DE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9B2DE2F0>]}


============================== 11:59:14.684052 | 4207359f-3e08-4221-91ea-c721bcb4f21b ==============================
[0m11:59:14.684052 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:59:14.686053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:17.032806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9B24BA00>]}
[0m11:59:17.262330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9A736470>]}
[0m11:59:17.263329 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m11:59:17.318462 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:59:18.038117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:18.040118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:18.067343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m11:59:18.219970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9CE09AE0>]}
[0m11:59:18.655540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9CD38070>]}
[0m11:59:18.656543 [info ] [MainThread]: Found 1 model, 492 macros
[0m11:59:18.657541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A98A8FC70>]}
[0m11:59:18.662539 [info ] [MainThread]: 
[0m11:59:18.664540 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m11:59:18.668539 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m11:59:18.718658 [debug] [ThreadPool]: dbt-sqlserver
[0m11:59:18.719649 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m11:59:18.720649 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:59:18.722650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:18.723647 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:59:19.153481 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m11:59:19.171481 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:59:19.176484 [debug] [ThreadPool]: On list_APIData: Close
[0m11:59:19.180483 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m11:59:19.197481 [debug] [ThreadPool]: dbt-sqlserver
[0m11:59:19.199482 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m11:59:19.200481 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:59:19.201481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:19.202481 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:59:19.203482 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m11:59:19.227115 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:59:19.232328 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m11:59:19.233962 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m11:59:19.237950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9BC326B0>]}
[0m11:59:19.240951 [debug] [MainThread]: On master: COMMIT
[0m11:59:19.243951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:59:19.248950 [info ] [MainThread]: 
[0m11:59:19.259951 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m11:59:19.261949 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m11:59:19.263950 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m11:59:19.264950 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m11:59:19.295317 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m11:59:19.312315 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m11:59:19.444058 [debug] [Thread-1 (]: dbt-sqlserver
[0m11:59:19.475335 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m11:59:19.503268 [debug] [Thread-1 (]: dbt-sqlserver
[0m11:59:19.505447 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:59:19.509610 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m11:59:19.511614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:59:19.513614 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m11:59:19.629288 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m11:59:19.649990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:59:19.654993 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:59:19.656993 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m11:59:19.678991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:59:19.716559 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m11:59:19.720556 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:59:19.722557 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m11:59:19.854288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:59:19.865292 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:59:19.866290 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m11:59:19.889390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:59:19.917442 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m11:59:19.922403 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m11:59:19.923437 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m11:59:19.924438 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m11:59:19.944401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:59:19.947401 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m11:59:19.950403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4207359f-3e08-4221-91ea-c721bcb4f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9CE271F0>]}
[0m11:59:19.951405 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 0.69s]
[0m11:59:19.952406 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m11:59:19.954404 [debug] [MainThread]: On master: COMMIT
[0m11:59:19.955404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:19.956402 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m11:59:19.957403 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m11:59:19.957403 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m11:59:19.958402 [info ] [MainThread]: 
[0m11:59:19.960406 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m11:59:19.961404 [debug] [MainThread]: Command end result
[0m11:59:20.013411 [info ] [MainThread]: 
[0m11:59:20.014403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:20.015402 [info ] [MainThread]: 
[0m11:59:20.016402 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:20.018402 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:20.018402 after 5.77 seconds
[0m11:59:20.019402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A988D0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9CD38A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A9CD95990>]}
[0m11:59:20.020406 [debug] [MainThread]: Flushing usage events
[0m13:37:49.691595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD05070580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07A87550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07A87370>]}


============================== 13:37:49.698554 | 40438726-5f3d-4c18-8034-b2263b43cb8b ==============================
[0m13:37:49.698554 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:37:49.699552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\ELTv2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:56.400231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD05105BA0>]}
[0m13:37:56.572671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07A862F0>]}
[0m13:37:56.574679 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m13:37:56.646163 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:37:59.130295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:59.132290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:59.158261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m13:37:59.283714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD095A9C00>]}
[0m13:37:59.744030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD082EBB80>]}
[0m13:37:59.745716 [info ] [MainThread]: Found 1 model, 492 macros
[0m13:37:59.747733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD082E8FD0>]}
[0m13:37:59.752301 [info ] [MainThread]: 
[0m13:37:59.754297 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:37:59.759294 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m13:37:59.807128 [debug] [ThreadPool]: dbt-sqlserver
[0m13:37:59.810048 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m13:37:59.812265 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:37:59.814102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:59.815738 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:38:00.496284 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m13:38:00.541991 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m13:38:00.545991 [debug] [ThreadPool]: On list_APIData: Close
[0m13:38:00.548993 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m13:38:00.574589 [debug] [ThreadPool]: dbt-sqlserver
[0m13:38:00.576807 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m13:38:00.578438 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:38:00.579517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:00.580049 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:38:00.581120 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m13:38:00.670300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:38:00.673301 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m13:38:00.674307 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m13:38:00.677305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0833BB80>]}
[0m13:38:00.678301 [debug] [MainThread]: On master: COMMIT
[0m13:38:00.679300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:00.680301 [info ] [MainThread]: 
[0m13:38:00.688300 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m13:38:00.689302 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m13:38:00.691301 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m13:38:00.692301 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m13:38:00.712340 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m13:38:00.718334 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m13:38:00.810807 [debug] [Thread-1 (]: dbt-sqlserver
[0m13:38:00.823808 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m13:38:00.838215 [debug] [Thread-1 (]: dbt-sqlserver
[0m13:38:00.839226 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:38:00.840230 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:38:00.841226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:38:00.843225 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:38:00.962503 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m13:38:01.019079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:01.022079 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:38:01.024078 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m13:38:01.049078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:01.077077 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m13:38:01.078078 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:38:01.080850 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m13:38:01.313666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:01.325665 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:38:01.326665 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products', 'Products__dbt_backup'
[0m13:38:01.983938 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m13:38:01.990934 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:38:01.991933 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m13:38:02.019376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:02.067945 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m13:38:02.079948 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m13:38:02.082944 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:38:02.083945 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m13:38:02.115943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:38:02.119942 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m13:38:02.122968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40438726-5f3d-4c18-8034-b2263b43cb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD05106080>]}
[0m13:38:02.124942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 1.43s]
[0m13:38:02.126944 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m13:38:02.129945 [debug] [MainThread]: On master: COMMIT
[0m13:38:02.130943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:02.131943 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m13:38:02.132944 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m13:38:02.134943 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m13:38:02.134943 [info ] [MainThread]: 
[0m13:38:02.135944 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m13:38:02.137945 [debug] [MainThread]: Command end result
[0m13:38:02.205189 [info ] [MainThread]: 
[0m13:38:02.206189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:02.207188 [info ] [MainThread]: 
[0m13:38:02.208189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:38:02.211188 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:02.210188 after 12.69 seconds
[0m13:38:02.212186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD05070580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0957E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0525CFA0>]}
[0m13:38:02.213186 [debug] [MainThread]: Flushing usage events
[0m13:52:36.049147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A960C30520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9636574F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A963657310>]}


============================== 13:52:36.057151 | 16b94780-7835-43d0-bf91-83018c54a278 ==============================
[0m13:52:36.057151 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:52:36.058150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\ELTv2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:37.593346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A960CC5B40>]}
[0m13:52:37.747034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A962FF2E00>]}
[0m13:52:37.748035 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m13:52:37.857009 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:52:38.425112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:38.426753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:38.443735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m13:52:38.507734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A965179BA0>]}
[0m13:52:38.813935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A963E93A90>]}
[0m13:52:38.814940 [info ] [MainThread]: Found 1 model, 492 macros
[0m13:52:38.815942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A960DEDA20>]}
[0m13:52:38.820603 [info ] [MainThread]: 
[0m13:52:38.822601 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:52:38.826600 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m13:52:38.867603 [debug] [ThreadPool]: dbt-sqlserver
[0m13:52:38.868604 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m13:52:38.869602 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:52:38.870603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:38.871604 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:52:39.226086 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m13:52:39.249747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:52:39.251748 [debug] [ThreadPool]: On list_APIData: Close
[0m13:52:39.253749 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m13:52:39.267748 [debug] [ThreadPool]: dbt-sqlserver
[0m13:52:39.268747 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m13:52:39.269748 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:52:39.270749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:39.270749 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:52:39.271748 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m13:52:39.367752 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:52:39.369753 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m13:52:39.370753 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m13:52:39.372748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9650A8AC0>]}
[0m13:52:39.373748 [debug] [MainThread]: On master: COMMIT
[0m13:52:39.374754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:39.375753 [info ] [MainThread]: 
[0m13:52:39.384355 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m13:52:39.385350 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m13:52:39.386352 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m13:52:39.388352 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m13:52:39.405348 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m13:52:39.406349 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m13:52:39.492544 [debug] [Thread-1 (]: dbt-sqlserver
[0m13:52:39.505298 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m13:52:39.518254 [debug] [Thread-1 (]: dbt-sqlserver
[0m13:52:39.519428 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:52:39.520006 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:52:39.521141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:39.522244 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:52:39.648657 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m13:52:39.715661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:52:39.718619 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:52:39.719619 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m13:52:39.741617 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:52:39.774617 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m13:52:39.778617 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:52:39.779621 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m13:52:39.848195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:52:39.850193 [debug] [Thread-1 (]: On model.my_gcp_project.products: ROLLBACK
[0m13:52:39.851195 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m13:52:39.852195 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\my_gcp_project\transformation\products.sql[0m
('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Landing.Landing_raw__stream_API_Source_Connector'. (208) (SQLMoreResults)")
[0m13:52:40.246848 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "D:\ELTv2\venv\lib\site-packages\dbt\task\base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "D:\ELTv2\venv\lib\site-packages\dbt\task\base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "D:\ELTv2\venv\lib\site-packages\dbt\task\base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "D:\ELTv2\venv\lib\site-packages\dbt\task\run.py", line 298, in execute
    result = MacroGenerator(
  File "D:\ELTv2\venv\lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\dbt_common\clients\jinja.py", line 299, in call_macro
    return macro(*args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "D:\ELTv2\venv\lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 82, in macro
  File "D:\ELTv2\venv\lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\dbt\clients\jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\dbt_common\clients\jinja.py", line 299, in call_macro
    return macro(*args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\jinja2\runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "D:\ELTv2\venv\lib\site-packages\jinja2\runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "D:\ELTv2\venv\lib\site-packages\jinja2\sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "D:\ELTv2\venv\lib\site-packages\dbt\adapters\base\impl.py", line 380, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "D:\ELTv2\venv\lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 530, in execute
    while cursor.nextset():
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Landing.Landing_raw__stream_API_Source_Connector'. (208) (SQLMoreResults)")

[0m13:52:40.249852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b94780-7835-43d0-bf91-83018c54a278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96523C100>]}
[0m13:52:40.250854 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model Landing.Products ......................... [[31mERROR[0m in 0.86s]
[0m13:52:40.252421 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m13:52:40.256425 [debug] [MainThread]: On master: COMMIT
[0m13:52:40.257426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:40.257426 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m13:52:40.258426 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m13:52:40.259426 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m13:52:40.259426 [info ] [MainThread]: 
[0m13:52:40.261422 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m13:52:40.264429 [debug] [MainThread]: Command end result
[0m13:52:40.323420 [info ] [MainThread]: 
[0m13:52:40.325431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:52:40.326423 [info ] [MainThread]: 
[0m13:52:40.328423 [error] [MainThread]:   ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Landing.Landing_raw__stream_API_Source_Connector'. (208) (SQLMoreResults)")
[0m13:52:40.330425 [info ] [MainThread]: 
[0m13:52:40.331425 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:52:40.335426 [debug] [MainThread]: Command `dbt run` failed at 13:52:40.334424 after 4.47 seconds
[0m13:52:40.336423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A960C30520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A96514E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A963FBBA00>]}
[0m13:52:40.337422 [debug] [MainThread]: Flushing usage events
[0m13:55:22.745915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF0700520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF310F4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF310F310>]}


============================== 13:55:22.753912 | fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa ==============================
[0m13:55:22.753912 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:55:22.754915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\ELTv2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:24.325526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF0795B40>]}
[0m13:55:24.778270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF2AC6E00>]}
[0m13:55:24.781111 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m13:55:24.853257 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:55:25.680473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:25.681471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:25.714887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m13:55:25.834683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF4C39BA0>]}
[0m13:55:26.412827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF3953A90>]}
[0m13:55:26.415840 [info ] [MainThread]: Found 1 model, 492 macros
[0m13:55:26.417829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF08BDA20>]}
[0m13:55:26.425825 [info ] [MainThread]: 
[0m13:55:26.427827 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:55:26.432824 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m13:55:26.475826 [debug] [ThreadPool]: dbt-sqlserver
[0m13:55:26.476825 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m13:55:26.478825 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:55:26.480840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:26.481829 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:55:26.930625 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m13:55:26.952619 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:26.955618 [debug] [ThreadPool]: On list_APIData: Close
[0m13:55:26.958619 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m13:55:26.988230 [debug] [ThreadPool]: dbt-sqlserver
[0m13:55:26.990229 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m13:55:26.992240 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:55:26.995237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:26.997231 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:55:26.999240 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m13:55:27.030226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:27.036235 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m13:55:27.040238 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m13:55:27.046284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF4B68AC0>]}
[0m13:55:27.048549 [debug] [MainThread]: On master: COMMIT
[0m13:55:27.050788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:27.052455 [info ] [MainThread]: 
[0m13:55:27.062628 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m13:55:27.064632 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m13:55:27.068622 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m13:55:27.072153 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m13:55:27.113233 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m13:55:27.116224 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m13:55:27.250787 [debug] [Thread-1 (]: dbt-sqlserver
[0m13:55:27.275788 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m13:55:27.305791 [debug] [Thread-1 (]: dbt-sqlserver
[0m13:55:27.308796 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:55:27.310788 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m13:55:27.313798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:27.315797 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m13:55:27.429933 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m13:55:27.452931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:27.458934 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:55:27.459933 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m13:55:27.482973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:27.534933 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m13:55:27.536931 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:55:27.537934 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m13:55:27.696963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:27.720966 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:55:27.721966 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m13:55:27.747419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:27.794822 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m13:55:27.801824 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m13:55:27.806347 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m13:55:27.808349 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m13:55:27.831402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:55:27.836395 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m13:55:27.841404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab1995a-0d7c-4bd1-ada6-ac3cfc2bb6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF0796020>]}
[0m13:55:27.843399 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 0.77s]
[0m13:55:27.844406 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m13:55:27.847397 [debug] [MainThread]: On master: COMMIT
[0m13:55:27.848396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:27.849629 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m13:55:27.850394 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m13:55:27.851394 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m13:55:27.852397 [info ] [MainThread]: 
[0m13:55:27.853395 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m13:55:27.857396 [debug] [MainThread]: Command end result
[0m13:55:27.979592 [info ] [MainThread]: 
[0m13:55:27.982604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:27.984599 [info ] [MainThread]: 
[0m13:55:27.987605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:28.000704 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:28.000704 after 5.44 seconds
[0m13:55:28.002706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF0700520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF08F0FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DF4BC98D0>]}
[0m13:55:28.007722 [debug] [MainThread]: Flushing usage events
[0m15:59:51.488277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBCDD0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBF7DE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBF7DE2F0>]}


============================== 15:59:51.497278 | dd45257a-7f4f-43d2-8428-9c3757dd5c02 ==============================
[0m15:59:51.497278 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:59:51.498244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\ELTv2\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir C:\\Users\\kumar\\.dbt --project-dir D:\\ELTv2', 'send_anonymous_usage_stats': 'True'}
[0m15:59:56.148175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBF74BA00>]}
[0m15:59:56.303542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBEC3A470>]}
[0m15:59:56.306377 [info ] [MainThread]: Registered adapter: sqlserver=1.8.2
[0m15:59:56.402621 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:59:59.947905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:59.956905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:59.995905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_gcp_project.add_columns
[0m16:00:00.229072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC1309AE0>]}
[0m16:00:00.920572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC1238070>]}
[0m16:00:00.922781 [info ] [MainThread]: Found 1 model, 492 macros
[0m16:00:00.924780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBCF8FC70>]}
[0m16:00:00.931778 [info ] [MainThread]: 
[0m16:00:00.937778 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m16:00:00.943780 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData'
[0m16:00:01.016265 [debug] [ThreadPool]: dbt-sqlserver
[0m16:00:01.019654 [debug] [ThreadPool]: Using sqlserver connection "list_APIData"
[0m16:00:01.021266 [debug] [ThreadPool]: On list_APIData: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData"} */
select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:00:01.022264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:01.024268 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m16:00:01.801843 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m16:00:01.861453 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m16:00:01.863464 [debug] [ThreadPool]: On list_APIData: Close
[0m16:00:01.867466 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_APIData_Landing'
[0m16:00:01.884464 [debug] [ThreadPool]: dbt-sqlserver
[0m16:00:01.886464 [debug] [ThreadPool]: Using sqlserver connection "list_APIData_Landing"
[0m16:00:01.887463 [debug] [ThreadPool]: On list_APIData_Landing: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "connection_name": "list_APIData_Landing"} */
USE [APIData];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'Landing'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m16:00:01.888465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:01.889465 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m16:00:01.891463 [debug] [ThreadPool]: sqlserver adapter: Connected to db: APIData
[0m16:00:02.025689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:00:02.030686 [debug] [ThreadPool]: On list_APIData_Landing: ROLLBACK
[0m16:00:02.033684 [debug] [ThreadPool]: On list_APIData_Landing: Close
[0m16:00:02.038682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC01326B0>]}
[0m16:00:02.040683 [debug] [MainThread]: On master: COMMIT
[0m16:00:02.041683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:02.043711 [info ] [MainThread]: 
[0m16:00:02.052688 [debug] [Thread-1 (]: Began running node model.my_gcp_project.products
[0m16:00:02.054687 [info ] [Thread-1 (]: 1 of 1 START sql table model Landing.Products .................................. [RUN]
[0m16:00:02.056685 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.my_gcp_project.products'
[0m16:00:02.058686 [debug] [Thread-1 (]: Began compiling node model.my_gcp_project.products
[0m16:00:02.092005 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_gcp_project.products"
[0m16:00:02.096047 [debug] [Thread-1 (]: Began executing node model.my_gcp_project.products
[0m16:00:02.241177 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:00:02.262172 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw"
[0m16:00:02.275172 [debug] [Thread-1 (]: dbt-sqlserver
[0m16:00:02.276172 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m16:00:02.278173 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

        USE [APIData];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'APIData'
        and refs.referenced_schema_name = 'Landing'
        and refs.referenced_entity_name = 'Products__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m16:00:02.278173 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:00:02.279516 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=34.65.104.120,1433;Database=APIData;UID={sqlserver};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.8.2
[0m16:00:02.394222 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: APIData
[0m16:00:02.455223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:00:02.459223 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m16:00:02.460224 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
      
    
    USE [APIData];
    EXEC('DROP view IF EXISTS "Landing"."Products__dbt_tmp__dbt_tmp_vw";');

[0m16:00:02.482226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:00:02.519223 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_gcp_project.products"
[0m16:00:02.522224 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m16:00:02.524224 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

  
    USE [APIData];
    USE [APIData];
    
    

    

    
    USE [APIData];
    EXEC('
        create view "Landing"."Products__dbt_tmp__dbt_tmp_vw" as -- transformation/products.sql




with raw_data as (
    select
        -- Extract the main fields from the JSON in _airbyte_data
        JSON_VALUE(_airbyte_data, ''$.id'') as product_id,
        JSON_VALUE(_airbyte_data, ''$.title'') as product_title,
        JSON_VALUE(_airbyte_data, ''$.description'') as product_description,
        JSON_VALUE(_airbyte_data, ''$.category'') as product_category,
        JSON_VALUE(_airbyte_data, ''$.price'') as product_price,
        JSON_VALUE(_airbyte_data, ''$.discountPercentage'') as discount_percentage,
        JSON_VALUE(_airbyte_data, ''$.rating'') as product_rating,
        JSON_VALUE(_airbyte_data, ''$.stock'') as stock_quantity,
        JSON_VALUE(_airbyte_data, ''$.sku'') as sku,
        JSON_VALUE(_airbyte_data, ''$.weight'') as product_weight,
        JSON_VALUE(_airbyte_data, ''$.dimensions.width'') as product_width,
        JSON_VALUE(_airbyte_data, ''$.dimensions.height'') as product_height,
        JSON_VALUE(_airbyte_data, ''$.dimensions.depth'') as product_depth,
        JSON_VALUE(_airbyte_data, ''$.warrantyInformation'') as warranty_info,
        JSON_VALUE(_airbyte_data, ''$.shippingInformation'') as shipping_info,
        JSON_VALUE(_airbyte_data, ''$.availabilityStatus'') as availability_status,
        JSON_VALUE(_airbyte_data, ''$.meta.createdAt'') as created_at,
        JSON_VALUE(_airbyte_data, ''$.meta.updatedAt'') as updated_at
    from Landing.Landing_raw__stream_API_Source_Connector
)

select * from raw_data;;
    ')

EXEC('
            SELECT * INTO "APIData"."Landing"."Products__dbt_tmp" FROM "APIData"."Landing"."Products__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS Landing.Products__dbt_tmp__dbt_tmp_vw')



    
    use [APIData];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'Landing_Products__dbt_tmp_cci'
        AND object_id=object_id('Landing_Products__dbt_tmp')
    )
    DROP index "Landing"."Products__dbt_tmp".Landing_Products__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX Landing_Products__dbt_tmp_cci
    ON "Landing"."Products__dbt_tmp"

   


  
[0m16:00:02.725301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:00:02.746707 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m16:00:02.748706 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products', 'Products__dbt_backup'
[0m16:00:03.157953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:00:03.178301 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m16:00:03.179298 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */
USE [APIData];
      EXEC sp_rename 'Landing.Products__dbt_tmp', 'Products'
[0m16:00:03.204298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:00:03.286474 [debug] [Thread-1 (]: On model.my_gcp_project.products: COMMIT
[0m16:00:03.299476 [debug] [Thread-1 (]: Applying DROP to: "APIData"."Landing"."Products__dbt_backup"
[0m16:00:03.304710 [debug] [Thread-1 (]: Using sqlserver connection "model.my_gcp_project.products"
[0m16:00:03.306470 [debug] [Thread-1 (]: On model.my_gcp_project.products: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "my_gcp_project", "target_name": "dev", "node_id": "model.my_gcp_project.products"} */

      
    USE [APIData];
    EXEC('DROP table IF EXISTS "Landing"."Products__dbt_backup";');

[0m16:00:03.336473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:00:03.341473 [debug] [Thread-1 (]: On model.my_gcp_project.products: Close
[0m16:00:03.347472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd45257a-7f4f-43d2-8428-9c3757dd5c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBCE65F60>]}
[0m16:00:03.349475 [info ] [Thread-1 (]: 1 of 1 OK created sql table model Landing.Products ............................. [[32mOK[0m in 1.29s]
[0m16:00:03.352480 [debug] [Thread-1 (]: Finished running node model.my_gcp_project.products
[0m16:00:03.356477 [debug] [MainThread]: On master: COMMIT
[0m16:00:03.357477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:03.359477 [debug] [MainThread]: Connection 'list_APIData' was properly closed.
[0m16:00:03.359477 [debug] [MainThread]: Connection 'list_APIData_Landing' was properly closed.
[0m16:00:03.360475 [debug] [MainThread]: Connection 'model.my_gcp_project.products' was properly closed.
[0m16:00:03.362475 [info ] [MainThread]: 
[0m16:00:03.364470 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m16:00:03.368478 [debug] [MainThread]: Command end result
[0m16:00:03.471354 [info ] [MainThread]: 
[0m16:00:03.475352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:03.477347 [info ] [MainThread]: 
[0m16:00:03.479347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:03.484348 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:03.484348 after 12.13 seconds
[0m16:00:03.487347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBCDD0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBFF081F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBFF0A170>]}
[0m16:00:03.489347 [debug] [MainThread]: Flushing usage events
